<!DOCTYPE html>
<html lang="zh-TW" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ch1. 計算機基礎 - 備考戰略儀表板</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        },
                        accent: {
                            400: '#38bdf8', // Light Blue
                            500: '#0ea5e9',
                            600: '#0284c7',
                        }
                    },
                    fontFamily: {
                        sans: ['Noto Sans TC', 'Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; }
        .card-flip {
            perspective: 1000px;
        }
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            cursor: pointer;
        }
        .card-inner.is-flipped {
            transform: rotateY(180deg);
        }
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
            padding: 1rem;
        }
        .card-back {
            transform: rotateY(180deg);
            background-color: #1e293b;
            border: 1px solid #38bdf8;
        }
        .bit-box {
            transition: all 0.3s ease;
        }
        .bit-active {
            background-color: #0ea5e9;
            color: white;
            box-shadow: 0 0 10px rgba(14, 165, 233, 0.5);
        }
    </style>
</head>
<body class="bg-slate-950 text-slate-200 min-h-screen p-4 md:p-8">

    <header class="max-w-4xl mx-auto mb-8 text-center border-b border-slate-800 pb-6">
        <h1 class="text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-accent-400 to-indigo-400 mb-2">
            Chapter 1. 計算機基礎
        </h1>
        <p class="text-slate-400 text-lg">從「人類思維」到「機器邏輯」的解碼器</p>
    </header>

    <main class="max-w-4xl mx-auto space-y-12">

        <section id="dashboard" class="bg-slate-900 rounded-xl p-6 border border-slate-800 shadow-lg">
            <h2 class="text-xl font-bold text-accent-400 mb-6 flex items-center">
                <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                戰略儀表板
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-slate-850 rounded-lg p-5 text-center">
                    <div class="text-slate-400 text-sm mb-2">考試出題佔比</div>
                    <div class="relative w-32 h-32 mx-auto flex items-center justify-center">
                        <svg class="w-full h-full transform -rotate-90">
                            <circle cx="64" cy="64" r="56" stroke="currentColor" stroke-width="8" fill="transparent" class="text-slate-700" />
                            <circle cx="64" cy="64" r="56" stroke="currentColor" stroke-width="8" fill="transparent" stroke-dasharray="351.86" stroke-dashoffset="320" class="text-accent-500" />
                        </svg>
                        <div class="absolute text-2xl font-bold text-white">9%</div>
                    </div>
                    <p class="text-xs text-slate-500 mt-2">約 22 題 (僅次於網路與資安)</p>
                </div>

                <div class="bg-slate-850 rounded-lg p-5 col-span-1 md:col-span-2 flex flex-col justify-center">
                    <div class="mb-4">
                        <span class="text-slate-400 text-sm">核心任務</span>
                        <p class="text-lg font-medium text-white mt-1">建立「硬體運作」的先備知識，解決人類資料 (Data) 如何轉化為電腦訊號 (Signal) 的問題。</p>
                    </div>
                    <div>
                        <span class="text-slate-400 text-sm">關鍵術語 Tag Cloud</span>
                        <div class="flex flex-wrap gap-2 mt-2">
                            <span class="px-2 py-1 bg-indigo-900 text-indigo-200 text-xs rounded border border-indigo-700">馮·紐曼架構</span>
                            <span class="px-2 py-1 bg-emerald-900 text-emerald-200 text-xs rounded border border-emerald-700">2的補數</span>
                            <span class="px-2 py-1 bg-amber-900 text-amber-200 text-xs rounded border border-amber-700">IEEE 754</span>
                            <span class="px-2 py-1 bg-slate-700 text-slate-300 text-xs rounded">ASCII/Unicode</span>
                            <span class="px-2 py-1 bg-red-900 text-red-200 text-xs rounded border border-red-700">截尾/捨入誤差</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="lab" class="bg-slate-900 rounded-xl p-6 border border-slate-800 shadow-lg relative overflow-hidden">
            <div class="absolute top-0 right-0 p-4 opacity-10">
                <svg class="w-32 h-32" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M3 4a1 1 0 011-1h3a1 1 0 011 1v3a1 1 0 01-1 1H4a1 1 0 01-1-1V4zm2 2V5h1v1H5zM3 13a1 1 0 011-1h3a1 1 0 011 1v3a1 1 0 01-1 1H4a1 1 0 01-1-1v-3zm2 2v-1h1v1H5zM13 3a1 1 0 00-1 1v3a1 1 0 001 1h3a1 1 0 001-1V4a1 1 0 00-1-1h-3zm1 2v1h1V5h-1z" clip-rule="evenodd"></path></svg>
            </div>
            
            <h2 class="text-xl font-bold text-accent-400 mb-2 flex items-center relative z-10">
                <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
                核心觀念實驗室：8位元補數解碼器
            </h2>
            <p class="text-sm text-slate-400 mb-6 relative z-10">動態模擬電腦如何儲存整數。請輸入一個數字（範圍 -128 到 127），觀察位元變化。</p>

            <div class="flex flex-col md:flex-row gap-8 relative z-10">
                <div class="w-full md:w-1/3 bg-slate-850 p-6 rounded-lg border border-slate-700">
                    <label class="block text-sm font-medium text-slate-300 mb-2">輸入十進位整數</label>
                    <input type="number" id="numInput" min="-128" max="127" value="-5" 
                           class="w-full bg-slate-900 border border-slate-600 rounded px-4 py-3 text-white focus:outline-none focus:border-accent-500 focus:ring-1 focus:ring-accent-500 transition">
                    <p class="text-xs text-slate-500 mt-2">支援範圍：-128 ~ 127 (8-bit)</p>
                    
                    <div class="mt-6 space-y-3">
                        <div class="flex justify-between text-sm">
                            <span class="text-slate-400">符號 (Sign):</span>
                            <span id="signText" class="font-mono text-accent-400">負數 (1)</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-slate-400">數值 (Value):</span>
                            <span id="absText" class="font-mono text-white">5</span>
                        </div>
                    </div>
                </div>

                <div class="w-full md:w-2/3 space-y-6">
                    
                    <div>
                        <div class="flex justify-between mb-1">
                            <span class="text-sm text-slate-400">步驟 1: 取得絕對值的二進位 (Magnitude)</span>
                            <span class="text-xs text-slate-500 font-mono">00000101</span>
                        </div>
                        <div class="flex gap-1" id="viz-magnitude">
                            </div>
                    </div>

                    <div id="negative-steps" class="opacity-100 transition-opacity duration-300">
                        <div class="flex justify-center my-2 text-slate-600">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg>
                        </div>

                        <div class="mb-6">
                            <div class="flex justify-between mb-1">
                                <span class="text-sm text-accent-400">步驟 2: 反轉所有位元 (1's Complement)</span>
                            </div>
                            <div class="flex gap-1" id="viz-ones"></div>
                        </div>

                        <div class="flex justify-center my-2 text-slate-600">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                            <span class="ml-2 text-xs font-mono pt-1">加 1</span>
                        </div>

                        <div>
                            <div class="flex justify-between mb-1">
                                <span class="text-sm text-emerald-400 font-bold">結果: 2的補數 (電腦儲存值)</span>
                                <span id="finalHex" class="text-xs text-emerald-600 font-mono">0xFB</span>
                            </div>
                            <div class="flex gap-1" id="viz-twos"></div>
                        </div>
                    </div>

                    <div id="positive-result" class="hidden text-center p-4 bg-emerald-900/20 border border-emerald-900 rounded">
                        <p class="text-emerald-400">正數的 2的補數 = 原碼本身</p>
                    </div>

                </div>
            </div>
        </section>

        <section id="drill" class="grid grid-cols-1 md:grid-cols-2 gap-8">
            
            <div>
                <h2 class="text-xl font-bold text-white mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-accent-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                    核心名詞閃示卡
                </h2>
                <div class="relative h-48 w-full group perspective" id="flashcard-container">
                    </div>
                <div class="flex justify-center mt-4 gap-4">
                    <button onclick="prevCard()" class="p-2 rounded-full bg-slate-800 hover:bg-slate-700 text-slate-300">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                    </button>
                    <span id="card-counter" class="py-2 text-sm text-slate-500">1 / 5</span>
                    <button onclick="nextCard()" class="p-2 rounded-full bg-slate-800 hover:bg-slate-700 text-slate-300">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                    </button>
                </div>
            </div>

            <div>
                <h2 class="text-xl font-bold text-white mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                    陷阱題偵測
                </h2>
                <div class="bg-slate-900 rounded-lg border border-slate-800 p-5">
                    <div id="quiz-container">
                        </div>
                </div>
            </div>

        </section>

        <footer class="text-center text-slate-600 text-sm pb-8 border-t border-slate-900 pt-8">
            <p>Designed for Learning Science & Frontend Development Demo</p>
        </footer>

    </main>

    <script>
        // --- Logic: Core Concept Lab (Base Conversion) ---
        const numInput = document.getElementById('numInput');
        
        function toBinArray(num) {
            let bin = (num >>> 0).toString(2);
            // Pad to 8 bits usually, but if num is large JS handles it. 
            // We force 8 bits for visualization
            while (bin.length < 8) bin = "0" + bin;
            if (bin.length > 8) bin = bin.slice(-8); // Truncate to 8 bits
            return bin.split('').map(Number);
        }

        function renderBits(containerId, bitArray, colorClass = 'bg-slate-700') {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            bitArray.forEach((bit, index) => {
                const box = document.createElement('div');
                box.className = `flex-1 h-10 md:h-12 flex items-center justify-center rounded text-sm md:text-base font-bold font-mono border border-slate-800 ${colorClass} ${bit === 1 ? 'bit-active' : 'text-slate-500 bg-slate-800'}`;
                box.innerText = bit;
                container.appendChild(box);
            });
        }

        function updateLab() {
            let val = parseInt(numInput.value);
            
            // Limit range visual
            if (val > 127) { val = 127; numInput.value = 127; }
            if (val < -128) { val = -128; numInput.value = -128; }

            const isNeg = val < 0;
            
            // Update Text Info
            document.getElementById('signText').innerText = isNeg ? "負數 (1)" : "正數 (0)";
            document.getElementById('absText').innerText = Math.abs(val);

            // 1. Magnitude (Absolute value binary)
            const absVal = Math.abs(val);
            const absBits = toBinArray(absVal);
            renderBits('viz-magnitude', absBits, 'bg-slate-700');

            if (isNeg) {
                document.getElementById('negative-steps').classList.remove('hidden');
                document.getElementById('positive-result').classList.add('hidden');

                // 2. One's Complement (Flip bits)
                const onesBits = absBits.map(b => b === 0 ? 1 : 0);
                renderBits('viz-ones', onesBits, 'text-accent-200');

                // 3. Two's Complement (Add 1)
                // In JS, bitwise NOT is ~num. 
                // We calculate manually for array visualization:
                let carry = 1;
                const twosBits = [...onesBits];
                for (let i = 7; i >= 0; i--) {
                    let sum = twosBits[i] + carry;
                    if (sum === 2) {
                        twosBits[i] = 0;
                        carry = 1;
                    } else {
                        twosBits[i] = sum;
                        carry = 0;
                    }
                }
                renderBits('viz-twos', twosBits, 'bg-emerald-600');
                
                // Show Hex
                let binStr = twosBits.join('');
                let hex = parseInt(binStr, 2).toString(16).toUpperCase().padStart(2, '0');
                document.getElementById('finalHex').innerText = "0x" + hex;

            } else {
                document.getElementById('negative-steps').classList.add('hidden');
                document.getElementById('positive-result').classList.remove('hidden');
                renderBits('viz-magnitude', absBits, 'bg-emerald-600'); // Show green for positive final
            }
        }

        numInput.addEventListener('input', updateLab);
        updateLab(); // Init

        // --- Logic: Flashcards ---
        const flashcards = [
            { q: "演算法的五大條件", a: "輸入、輸出、明確性、有限性、有效性。(缺少有限性會變成無窮迴圈)" },
            { q: "截尾誤差 (Truncation Error)", a: "因無法處理無窮位數(如 π)，強行切斷後面的位數所造成的誤差。" },
            { q: "捨入誤差 (Rounding Error)", a: "因電腦位元數有限，進行四捨五入或進位時產生的誤差。" },
            { q: "馮·紐曼架構五大單元", a: "輸入(Input)、輸出(Output)、記憶(Memory)、算術邏輯(ALU)、控制(CU)。" },
            { q: "2的補數優點", a: "只有一個 0 (+0)，且可以直接將減法運算變為加法運算，簡化硬體設計。" }
        ];

        let currentCard = 0;
        const cardContainer = document.getElementById('flashcard-container');
        const countSpan = document.getElementById('card-counter');

        function renderCard() {
            const data = flashcards[currentCard];
            cardContainer.innerHTML = `
                <div class="card-inner cursor-pointer" onclick="this.classList.toggle('is-flipped')">
                    <div class="card-front bg-slate-800 border border-slate-700 shadow-md">
                        <h3 class="text-lg font-bold text-accent-400">${data.q}</h3>
                        <p class="absolute bottom-4 text-xs text-slate-500">點擊翻面</p>
                    </div>
                    <div class="card-back flex flex-col">
                        <p class="text-base text-slate-200">${data.a}</p>
                    </div>
                </div>
            `;
            countSpan.innerText = `${currentCard + 1} / ${flashcards.length}`;
        }

        function nextCard() {
            currentCard = (currentCard + 1) % flashcards.length;
            renderCard();
        }
        function prevCard() {
            currentCard = (currentCard - 1 + flashcards.length) % flashcards.length;
            renderCard();
        }
        renderCard();

        // --- Logic: Scenario Quiz ---
        const scenarios = [
            {
                q: "陷阱 1：若用 8-bit 2's Complement 儲存數字，計算 127 + 1 會發生什麼？",
                options: ["變成 128", "發生 Overflow，變成 -128", "變成 0"],
                correct: 1,
                reason: "127 (01111111) + 1 (00000001) = 10000000。在 2的補數系統中，首位為 1 代表負數，故變成 -128 (Overflow)。"
            },
            {
                q: "陷阱 2：IEEE 754 浮點數能否精確表示 0.1？",
                options: ["可以", "不行，會有精確度流失"],
                correct: 1,
                reason: "0.1 在二進位是無窮循環小數 (0.000110011...)，存入有限位元會產生誤差。"
            },
            {
                q: "陷阱 3：演算法只要正確解決問題，步驟無限多也可以嗎？",
                options: ["可以", "不可以"],
                correct: 1,
                reason: "不可以。演算法必須符合「有限性 (Finiteness)」，必須在有限步驟內結束。"
            }
        ];

        let currentQuiz = 0;
        const quizBox = document.getElementById('quiz-container');

        function renderQuiz() {
            const s = scenarios[currentQuiz];
            let optionsHtml = s.options.map((opt, idx) => 
                `<button onclick="checkAnswer(${idx})" class="w-full text-left p-3 rounded bg-slate-800 hover:bg-slate-700 border border-slate-700 mb-2 transition text-sm text-slate-300 hover:text-white">${opt}</button>`
            ).join('');

            quizBox.innerHTML = `
                <p class="text-white font-medium mb-4">Q${currentQuiz+1}: ${s.q}</p>
                <div id="options-area">${optionsHtml}</div>
                <div id="reason-area" class="hidden mt-4 p-3 bg-slate-800 rounded border-l-4 border-accent-500 text-sm text-slate-300"></div>
                <div class="mt-4 flex justify-end">
                     ${currentQuiz < scenarios.length - 1 
                        ? `<button onclick="nextQuiz()" class="text-xs text-slate-500 hover:text-white underline">下一題</button>` 
                        : `<span class="text-xs text-green-500">完成練習!</span>`}
                </div>
            `;
        }

        function checkAnswer(idx) {
            const s = scenarios[currentQuiz];
            const reasonArea = document.getElementById('reason-area');
            const optionsArea = document.getElementById('options-area');
            
            // Disable buttons
            const buttons = optionsArea.querySelectorAll('button');
            buttons.forEach((btn, i) => {
                btn.disabled = true;
                if (i === s.correct) btn.classList.add('bg-green-900', 'border-green-600', 'text-green-200');
                else if (i === idx) btn.classList.add('bg-red-900', 'border-red-600', 'text-red-200');
            });

            reasonArea.innerHTML = `<strong class="${idx === s.correct ? 'text-green-400' : 'text-red-400'}">${idx === s.correct ? '答對了！' : '答錯了。'}</strong> ${s.reason}`;
            reasonArea.classList.remove('hidden');
        }

        function nextQuiz() {
            currentQuiz++;
            renderQuiz();
        }

        renderQuiz();

    </script>
</body>
</html>